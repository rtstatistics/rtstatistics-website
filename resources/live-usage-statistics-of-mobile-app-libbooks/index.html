<!DOCTYPE html>

<html lang="en-US">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Demo &#8211; Live statistics: Usage of mobile app &#8220;LibBooks&#8221; | rtstatistics.com</title>

<link rel="profile" href="http://gmpg.org/xfn/11">

<link rel="pingback" href="./../../xmlrpc.php">

<!--[if lt IE 9]>
<script src="./wp-content/themes/zerif-lite/js/html5.js"></script>
<link rel="stylesheet" href="./wp-content/themes/zerif-lite/css/ie.css" type="text/css">
<![endif]-->

<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="rtstatistics.com &raquo; Feed" href="./../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="rtstatistics.com &raquo; Comments Feed" href="./../../comments/feed/index.html" />
<link rel='stylesheet' id='zerif_font-css'  href='./../../wp-content/themes/zerif-lite/css/zerif_slug_fonts.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_font_all-css'  href='./../../wp-content/themes/zerif-lite/css/open-sans_font_34678.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_bootstrap_style-css'  href='./../../wp-content/themes/zerif-lite/css/bootstrap.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_fontawesome-css'  href='./../../wp-content/themes/zerif-lite/css/font-awesome.min.css?ver=v1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_pixeden_style-css'  href='./../../wp-content/themes/zerif-lite/css/pixeden-icons.css?ver=v1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_style-css'  href='./../../wp-content/themes/zerif-lite/style.css?ver=v1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_responsive_style-css'  href='./../../wp-content/themes/zerif-lite/css/responsive.css?ver=v1' type='text/css' media='all' />
<link rel='stylesheet' id='customized_style-css'  href='./../../wp-content/themes/zerif-lite/css/customized.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='./../../wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='./../../wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='./../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="./../../xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="./index.html" />
<link rel='shortlink' href='./../../index.html?p=101' />
<link rel="alternate" type="application/json+oembed" href="./../../wp-json/oembed/1.0/embed/index.html?url=http%3A%2F%2F%2Fresources%2Flive-usage-statistics-of-mobile-app-libbooks%2F" />
<link rel="alternate" type="text/xml+oembed" href="./../../wp-json/oembed/1.0/embed/index.html?url=http%3A%2F%2F%2Fresources%2Flive-usage-statistics-of-mobile-app-libbooks%2F&#038;format=xml" />
<link rel="alternate" href="./index.html" hreflang="en" />
<link rel="alternate" href="http://zh.rtstatistics.com/zh-resources/live-usage-statistics-of-mobile-app-libbooks/" hreflang="zh" />
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-image: url('./../wp-content/uploads/2015/12/bubble_1920x1280.jpg'); background-repeat: repeat; background-position: top left; background-attachment: scroll; }
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70952510-1', {'siteSpeedSampleRate':100,'sampleRate':100});
  ga('send', 'pageview');

</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?309dadd6cd25f3a327bc34ca4c26df47";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<style type="text/css">
code{
  font-size:14px;
  color: #404040;
}
td code{
  background-color:white;
}
pre{
  font-size:15px;
}
</style>
<!-- Block (7) START-->
<script>var $=jQuery.noConflict();</script>

<link href="//cdn.bootcss.com/c3/0.4.10/c3.min.css" rel="stylesheet" type="text/css">
<script src="//apps.bdimg.com/libs/d3/3.4.8/d3.min.js" charset="utf-8"></script>
<script src="//cdn.bootcss.com/c3/0.4.10/c3.min.js"></script>

<script src="//apps.bdimg.com/libs/moment/2.8.3/moment.js"></script>
<script src="./../../wp-content/uploads/2016/04/cjtsd.min_.js"></script>

<link href="//cdn.bootcss.com/bootstrap-slider/6.1.1/css/bootstrap-slider.min.css" rel="stylesheet" type="text/css">
<script src="//cdn.bootcss.com/bootstrap-slider/6.1.1/bootstrap-slider.min.js"></script>

<script src="./../../wp-content/uploads/2016/04/loader.js"></script>
<!-- Block (7) END -->
<link rel="icon" href="./../../wp-content/uploads/2015/12/logo_240-150x150.png" sizes="32x32" />
<link rel="icon" href="./../../wp-content/uploads/2015/12/logo_240.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="./../../wp-content/uploads/2015/12/logo_240.png" />
<meta name="msapplication-TileImage" content="./wp-content/uploads/2015/12/logo_240.png" />

</head>




	<body class="page page-id-101 page-child parent-pageid-46 page-template page-template-template-fullwidth page-template-template-fullwidth-php" >






<!-- =========================

   PRE LOADER

============================== -->


<header id="home" class="header">

	<div id="main-nav" class="navbar navbar-inverse bs-docs-nav" role="banner">

		<div class="container-fluid">

			<div class="navbar-header responsive-logo">

				<button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">

				<span class="sr-only">Toggle navigation</span>

				<span class="icon-bar"></span>

				<span class="icon-bar"></span>

				<span class="icon-bar"></span>

				</button>



				<a href="./../../index.html" class="navbar-brand"><img src="../../wp-content/uploads/2015/12/logo_name_32w.png" alt="rtstatistics.com"></a>


			</div>

			<nav class="navbar-collapse bs-navbar-collapse collapse" role="navigation"   id="site-navigation">

				<ul id="menu-default-menu" class="nav navbar-nav navbar-right responsive-nav main-nav-list"><li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32"><a href="./../../products/index.html">Products</a></li>
<li id="menu-item-59" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-59"><a href="./../../solutions/index.html">Solutions</a></li>
<li id="menu-item-58" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-58"><a href="./../../pricing/index.html">Pricing</a></li>
<li id="menu-item-57" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor current-menu-ancestor current-menu-parent current-custom-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-57"><a href="./../index.html">Resources</a>
<ul class="sub-menu">
	<li id="menu-item-93" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-93"><a href="./../how-to-send-data-to-rtstatistics-com-in-5-minutes/index.html">Tutorial: How to send data to rtstatistics.com in 5 minutes</a></li>
	<li id="menu-item-244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-244"><a href="./../how-to-setup-real-time-statistics-in-5-minutes/index.html">Tutorial: How to setup real-time statistics in 5 minutes</a></li>
	<li id="menu-item-128" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-128"><a href="./../live-statistics-trump-vs-clinton-according-to-comments-in-askreddit/index.html">Demo &#8211; Live statistics: Trump vs. Clinton according to comments in &#8220;askreddit&#8221;</a></li>
	<li id="menu-item-112" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-101 current_page_item menu-item-112"><a href="./index.html">Demo &#8211; Live usage statistics of mobile app &#8220;LibBooks&#8221;</a></li>
	<li id="menu-item-302" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor current-custom-parent menu-item-302"><a href="./../index.html">More resources &#8230;</a></li>
</ul>
</li>
<li id="menu-item-8" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8"><a href="https://manage.rtstatistics.com/auth/login">Log in</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-37"><a href="#">Language/语言</a>
<ul class="sub-menu">
	<li id="menu-item-33-en" class="lang-item lang-item-2 lang-item-en lang-item-first current-lang menu-item menu-item-type-custom menu-item-object-custom menu-item-33-en"><a href="./index.html" hreflang="en-US" lang="en-US"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAIAAAD5gJpuAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHzSURBVHjaYkxOP8IAB//+Mfz7w8Dwi4HhP5CcJb/n/7evb16/APL/gRFQDiAAw3JuAgAIBEDQ/iswEERjGzBQLEru97ll0g0+3HvqMn1SpqlqGsZMsZsIe0SICA5gt5a/AGIEarCPtFh+6N/ffwxA9OvP/7//QYwff/6fZahmePeB4dNHhi+fGb59Y4zyvHHmCEAAAW3YDzQYaJJ93a+vX79aVf58//69fvEPlpIfnz59+vDhw7t37968efP3b/SXL59OnjwIEEAsDP+YgY53b2b89++/awvLn98MDi2cVxl+/vl6mituCtBghi9f/v/48e/XL86krj9XzwEEEENy8g6gu22rfn78+NGs5Ofr16+ZC58+fvyYwX8rxOxXr169fPny+fPn1//93bJlBUAAsQADZMEBxj9/GBxb2P/9+S/R8u3vzxuyaX8ZHv3j8/YGms3w8ycQARmi2eE37t4ACCDGR4/uSkrKAS35B3TT////wADOgLOBIaXIyjBlwxKAAGKRXjCB0SOEaeu+/y9fMnz4AHQxCP348R/o+l+//sMZQBNLEvif3AcIIMZbty7Ly6t9ZmXl+fXj/38GoHH/UcGfP79//BBiYHjy9+8/oUkNAAHEwt1V/vI/KBY/QSISFqM/GBg+MzB8A6PfYC5EFiDAABqgW776MP0rAAAAAElFTkSuQmCC" title="English" alt="English" /><span style="margin-left:0.3em;">English</span></a></li>
	<li id="menu-item-33-zh" class="lang-item lang-item-5 lang-item-zh menu-item menu-item-type-custom menu-item-object-custom menu-item-33-zh"><a href="../../zh-resources/live-usage-statistics-of-mobile-app-libbooks/index.html" hreflang="zh-CN" lang="zh-CN"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAIAAAD5gJpuAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAFqSURBVHjaYrzOwPAPjJgYQEDAleHVbhADIvgHLPgHiQ0QQCxAlkR9NW8sw+cV/1gV/7Gb/hV4+vfzhj8Mv/78//Pn/+/f/8AkhH1t0yaAAAJp4I37zyz2lDfu79uqv/++/WYz+cuq/vvLxt8gdb+A5K9/v34B2SyyskBLAAII5JAva/7/+/z367a/f3/8ZuT9+//Pr78vQUrB6n4CSSj6/RuoASCAWEDO/fD3ddEfhv9/OE3/sKj8/n7k9/fDQNUIs/+DVf8HawAIIJCT/v38C3Hr95N/GDh/f94AVvT7N8RUBpjxQAVADQABBNLw/y/Ifwy/f/399ufTOpDBEPf8g5sN0QBEDAwAAQTWABEChgOSA9BVA00E2wAQQCANQBbEif/AzoCqgLkbbBYwWP/+//sXqBYggFhAkfL7D7OkJFCOCSj65zfUeFjwg8z++/ffX5AGoGKAAGI8jhSRyIw/SJH9D4aAYQoQYAA6rnMw1jU2vQAAAABJRU5ErkJggg==" title="中文 (中国)" alt="中文 (中国)" /><span style="margin-left:0.3em;">中文 (中国)</span></a></li>
</ul>
</li>
</ul>
			</nav>

		</div>

	</div>

	<!-- / END TOP BAR -->

<div class="clear"></div>

</header> <!-- / END HOME SECTION  -->



	<div id="content" class="site-content">

<div class="container">



<div class="content-left-wrap col-md-12">

	<div id="primary" class="content-area">

		<main id="main" class="site-main" role="main">



			


				


<article id="post-101" class="post-101 page type-page status-publish hentry">

	<header class="entry-header">
			</header><!-- .entry-header -->



	<div class="entry-content">

		<h1> Live statistics: Usage of mobile app &#8220;LibBooks&#8221;</h1>
<p>&nbsp;</p>
<p>Charts below on this page show live statistics of the usage of &#8220;<a href="https://play.google.com/store/apps/details?id=net.sf.jabb.pri.lb" target="_blank">LibBooks</a>&#8221; &#8211; a mobile app helping people checking library book loans and reservations.</p>
<p>Events generated by the mobile app are sent through REST API (POST <a href="https://api.rtstatistics.com/" target="_blank">https://api.rtstatistics.com/dataset/{id}/items</a>) directly from mobile devices. rtstatistics.com does the number crunching to generate the statistics. This page queries the statistics through REST API (GET <a href="https://api.rtstatistics.com/" target="_blank">https://api.rtstatistics.com/statistics/{id}/detail</a>). The delay from the event gets received to updated statistics can be queried is typically less than 1 second.</p>
<p>Charts on this page use <a href="http://c3js.org/">c3.js</a>+<a href="https://d3js.org/">d3.js</a> or <a href="https://developers.google.com/chart/">Google Charts</a> for drawing the charts, and <a href="https://github.com/james-hu/cjtsd-js">cjtsd-js</a> is used for transforming the query results into the format that c3.js and Google Charts require.</p>
<p>Source code of this demo can be found <a href="https://github.com/rtstatistics/rtstatistics-demo-pages" target="_blank">here</a>.</p>
<p>You can adjust the refresh interval of these charts manually. During refreshes, if new statistics are fetched from the server, the charts will reflect the changes. If you don&#8217;t touch it for a few minutes, the interval will be automatically increased until reaching 60 seconds.</p>
<p>Refresh interval (seconds):       <input id="inputRefreshIntervalSlider" type="text" /></p>
<p>&nbsp;</p>
<h3>Total event counts per 5 minutes (UTC)</h3>
<div id="divChartTotalEventCountsPer5MinUTC"></div>
<p>This chart shows total number of usage events collected from the mobile app per 5 minutes. Statistics of last 48 hours are shown.</p>
<p>The chart is drawn with c3.js and displays UTC time.</p>
<p>&nbsp;</p>
<h3>Unique users per 1 hour (Melbourne time)</h3>
<div id="divChartUniqueUsersPer1HourMelbourne"></div>
<p>Every event sent from the mobile app contains an installation id which is a UUID generated during installation. By counting the number of unique installation ids, we can find out how many unique users are actively using this mobile app.</p>
<p>The chart shows number of unique users per 1 hour. Statistics of last 48 hours are shown.</p>
<p>The chart is drawn with c3.js and displays Melbourne time (with Daylight saving observed when applicable).</p>
<p>&nbsp;</p>
<h3>UpdateAll operation time (seconds) by number of library accounts (UTC)</h3>
<div class="container-fluid">
<div class="row">
<div class="col-md-3">
<h4>Today</h4>
<div id="divChartUpdateAllTimeByLibraryAccountsTodayUTC">若在墙里可能看不见图</div>
</div>
<div class="col-md-3">
<h4>Yesterday</h4>
<div id="divChartUpdateAllTimeByLibraryAccountsYesterdayUTC">若在墙里可能看不见图</div>
</div>
<div class="col-md-3">
<h4>This month</h4>
<div id="divChartUpdateAllTimeByLibraryAccountsThisMonthUTC">若在墙里可能看不见图</div>
</div>
<div class="col-md-3">
<h4>Last month</h4>
<div id="divChartUpdateAllTimeByLibraryAccountsLastMonthUTC">若在墙里可能看不见图</div>
</div>
</div>
</div>
<p>Multiple library accounts can be configured in the mobile app. Loans and reservations of all library accounts are updated together in parallel. These charts show the minimal, maximal, and average time (number of seconds) used by the UpdateAll operation. Statistics for users with different numbers of library accounts are calculated separately.</p>
<p>As you can see from the charts, time used by UpdateAll operation probably depends more on network condition and number of books involved rather than number of library accounts.</p>
<p>The charts are drawn with Google Charts library and display UTC time.</p>
<p>&nbsp;</p>
<h2>Other resources</h2>
<ul>
<li><a href="http://en.rtstatistics.com/resources/live-statistics-trump-vs-clinton-according-to-comments-in-askreddit/">Demo – Live statistics: Trump vs. Clinton according to comments in “askreddit”</a></li>
<li><a href="http://en.rtstatistics.com/resources/how-to-send-data-to-rtstatistics-com-in-5-minutes/">Tutorial: How to send data to rtstatistics.com in 5 minutes</a></li>
<li><a href="./../how-to-setup-real-time-statistics-in-5-minutes/index.html">Tutorial: How to setup real-time statistics in 5 minutes</a></li>
</ul>

		
	</div><!-- .entry-content -->

	
</article><!-- #post-## -->


				


			


		</main><!-- #main -->

	</div><!-- #primary -->

</div><!-- .content-left-wrap -->




</div><!-- .container -->


	</div><!-- .site-content -->

<footer id="footer">

<div class="container">



	<div class="col-md-3 company-details"><div class="icon-top green-text"><img src="./../../wp-content/themes/zerif-lite/images/envelope4-green.png"></div><a href="mailto:info@rtstatistics.com">info@rtstatistics.com</a></div><div class="col-md-3 copyright"><ul class="social"><li><a target="_blank" href="#"><i class="fa fa-facebook"></i></a></li><li><a target="_blank" href="#"><i class="fa fa-twitter"></i></a></li><li><a target="_blank" href="http://www.linkedin.com/company/rtstatistics-com"><i class="fa fa-linkedin"></i></a></li></ul>Copyright ©2015-2016 Real-time Statistics Technologies</div>
</div> <!-- / END CONTAINER -->

</footer> <!-- / END FOOOTER  -->



<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/bootstrap.min.js?ver=20120206'></script>
<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/jquery.knob.js?ver=20120206'></script>
<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/smoothscroll.js?ver=20120206'></script>
<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/scrollReveal.js?ver=20120206'></script>
<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/zerif.js?ver=20120206'></script>

<!-- Block (1) START-->
  <script>
  var queryKey = "pvSq0wgTE9jK1FhSWy2hy71guTJRWTktHttGzY0uKA8bvf-kJXIE-i9Fi7imdilIQggZYL6pJqmTTQKrQRVStw";

  var googleChartsLibLoaded = false;

  var refreshIntervalSlider;
  var timeoutRefreshRefreshIntervalSlider;

  var chartTotalEventCountsPer5MinUTC;
  var timeoutRefreshTotalEventCountsPer5MinUTC;

  var chartUniqueUsersPer1HourMelbourne;
  var timeoutRefreshUniqueUsersPer1HourMelbourne;

  var chartUpdateAllTimeByLibraryAccountsTodayUTC;
  var timeoutRefreshUpdateAllTimeByLibraryAccountsTodayUTC;

  var chartUpdateAllTimeByLibraryAccountsYesterdayUTC;
  var timeoutRefreshUpdateAllTimeByLibraryAccountsYesterdayUTC;

  var chartUpdateAllTimeByLibraryAccountsThisMonthUTC;
  var timeoutRefreshUpdateAllTimeByLibraryAccountsThisMonthUTC;

  var chartUpdateAllTimeByLibraryAccountsLastMonthUTC;
  var timeoutRefreshUpdateAllTimeByLibraryAccountsLastMonthUTC;


  $(function(){
    bindChartsAndStartRefresh();
  });

  function bindChartsAndStartRefresh(){
    chartTotalEventCountsPer5MinUTC = c3.generate({
      bindto: '#divChartTotalEventCountsPer5MinUTC',
      data: {
        x: 'time',
        xFormat: '%Y-%m-%d %H:%M',
        columns: [
        ],
        type: 'bar'
      },
      bar: {
        width: {
          ratio: 0.9
        }
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            count: 576,
            culling: {
              max: 3
            },
            format: '%Y-%m-%d %H:%M'
          }
        }
      }
    });

    chartUniqueUsersPer1HourMelbourne = c3.generate({
      bindto: '#divChartUniqueUsersPer1HourMelbourne',
      data: {
        x: 'time',
        xFormat: '%Y-%m-%d %H:%M',
        columns: [
        ],
        type: 'bar'
      },
      bar: {
        width: {
          ratio: 0.9
        }
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            count: 48,
            culling: {
              max: 3
            },
            format: '%Y-%m-%d %H:00'
          }
        }
      }
    });

    startRefresh();
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(function(){
      googleChartsLibLoaded = true;
    });
  }

  function startRefresh(){
    refreshIntervalSlider = new Slider("#inputRefreshIntervalSlider", {
      min: 1,
      max: 60,
      value: 1,
      tooltip_position: "bottom"
    });
    refreshIntervalSlider.on("slideStop", onNewRefreshInterval);
    refreshIntervalSlider.on("slideEnabled", onNewRefreshInterval);

    onNewRefreshInterval();

    $("body").mousemove(function(){
      if (refreshIntervalSlider.getValue() > 1){
        refreshIntervalSlider.setValue(1);
        onNewRefreshInterval();
      }
    });
  }

  function onNewRefreshInterval(){
    clearTimeout(timeoutRefreshRefreshIntervalSlider);
    resetRefreshing();
    var seconds = refreshIntervalSlider.getValue();
    if (seconds < 60){
      timeoutRefreshRefreshIntervalSlider = setTimeout(function(){
        var seconds = refreshIntervalSlider.getValue();
        if (seconds < 60){
          refreshIntervalSlider.disable();
          if (seconds < 10){
            refreshIntervalSlider.setValue(10);
          }else if (seconds < 20){
            refreshIntervalSlider.setValue(20);
          }else if (seconds < 30){
            refreshIntervalSlider.setValue(30);
          }else if (seconds < 40){
            refreshIntervalSlider.setValue(40);
          }else if (seconds < 50){
            refreshIntervalSlider.setValue(50);
          }else{
            refreshIntervalSlider.setValue(60);
          }
          refreshIntervalSlider.enable();
        }
      }, 60000 * (2 + Math.floor(seconds/30)));  // increase values after n minutes
    }
  }

  function resetRefreshing(){
    clearTimeout(timeoutRefreshTotalEventCountsPer5MinUTC);
    updateTotalEventCountsPer5MinUTC();

    clearTimeout(timeoutRefreshUniqueUsersPer1HourMelbourne);
    updateUniqueUsersPer1HourMelbourne();

    clearTimeout(timeoutRefreshUpdateAllTimeByLibraryAccountsTodayUTC);
    updateUpdateAllTimeByLibraryAccountsTodayUTC();

    clearTimeout(timeoutRefreshUpdateAllTimeByLibraryAccountsYesterdayUTC);
    updateUpdateAllTimeByLibraryAccountsYesterdayUTC();

    clearTimeout(timeoutRefreshUpdateAllTimeByLibraryAccountsThisMonthUTC);
    updateUpdateAllTimeByLibraryAccountsThisMonthUTC();

    clearTimeout(timeoutRefreshUpdateAllTimeByLibraryAccountsLastMonthUTC);
    updateUpdateAllTimeByLibraryAccountsLastMonthUTC();
  }

  function formatTime(hourOffset, zoneOffset, format){
    if (zoneOffset === undefined){
      zoneOffset = 0;
    }
    var now = Date.now() + zoneOffset;
    if (format === undefined){
      format = "YYYYMMDDHHmm";
    }
    return moment(now + 1000*60*60*hourOffset).utc().format(format);
  }

  function updateTotalEventCountsPer5MinUTC(){
    var query;
    query = "https://api.rtstatistics.com/statistics/AA$S2hKMyHhKFbkP6MBEUuS$_zwu3bCXfwmLvUCf1hXo/detail?"
      + "_period=5 minutes"
      + "&_columns=count"
      + "&_from=" + formatTime(-48)
      + "&_to=" + formatTime(1)
      + "&api_key=" + queryKey;
    $.ajax(query)
      .done(function(result){
        if (!result.error){
          var data = result;
          var timeCol = cjtsd.getFormattedTimestamps(data, 'YYYY-MM-DD HH:mm', 'time');
          var dataCol = cjtsd.prepend(data.c, 'Total number of events per 5 minutes')
          chartTotalEventCountsPer5MinUTC.load({
            columns: [
              timeCol,
              dataCol
            ]
          });
          $("#divChartTotalEventCountsPer5MinUTC .tick line").css("opacity", 0);
        }else{
          if (console && console.log){
            console.log("No valid result for query '" + query + "', result: " + result);
          }
        }
      })
      .always(function(){
        var interval = 1000 * refreshIntervalSlider.getValue();
        timeoutRefreshTotalEventCountsPer5MinUTC = setTimeout(updateTotalEventCountsPer5MinUTC, interval);
      });
  }

  function updateUniqueUsersPer1HourMelbourne(){
    var query;
    query = "https://api.rtstatistics.com/statistics/AA$S2hKMyHhKFbkP6MBEUuS$QCg-eUgK5ERNyE1OWLQu/detail?"
      + "_period=1 hour"
      + "&_zone=Australia/Melbourne"
      + "&_columns=unique,values"
      + "&_from=" + formatTime(-48)
      + "&_to=" + formatTime(1)
      + "&api_key=" + queryKey;
    $.ajax(query)
      .done(function(result){
        if (!result.error){
          var data = result;
          var timeCol = cjtsd.getFormattedTimestamps(data, 'YYYY-MM-DD HH:mm', 'time');
          var dataCol = cjtsd.prepend(data.n, 'Number of unique users per 1 hour')
          chartUniqueUsersPer1HourMelbourne.load({
            columns: [
              timeCol,
              dataCol
            ]
          });
          $("#divChartUniqueUsersPer1HourMelbourne .tick line").css("opacity", 0);
        }else{
          if (console && console.log){
            console.log("No valid result for query '" + query + "', result: " + result);
          }
        }
      })
      .always(function(){
        var interval = 1000 * refreshIntervalSlider.getValue();
        timeoutRefreshUniqueUsersPer1HourMelbourne = setTimeout(updateUniqueUsersPer1HourMelbourne, interval);
      });
  }

  function updateUpdateAllTimeByLibraryAccountsTodayUTC(){
    updateUpdateAllTimeByLibraryAccountsUTC('chartUpdateAllTimeByLibraryAccountsTodayUTC', "day", 0, 24, function(interval){
      timeoutRefreshUpdateAllTimeByLibraryAccountsTodayUTC = setTimeout(updateUpdateAllTimeByLibraryAccountsTodayUTC, interval);
    });
  }

  function updateUpdateAllTimeByLibraryAccountsYesterdayUTC(){
    updateUpdateAllTimeByLibraryAccountsUTC('chartUpdateAllTimeByLibraryAccountsYesterdayUTC', "day", -24, 0, function(interval){
      timeoutRefreshUpdateAllTimeByLibraryAccountsYesterdayUTC = setTimeout(updateUpdateAllTimeByLibraryAccountsYesterdayUTC, interval);
    });
  }

  function updateUpdateAllTimeByLibraryAccountsThisMonthUTC(){
    updateUpdateAllTimeByLibraryAccountsUTC('chartUpdateAllTimeByLibraryAccountsThisMonthUTC', "month", 0, 30*24, function(interval){
      timeoutRefreshUpdateAllTimeByLibraryAccountsThisMonthUTC = setTimeout(updateUpdateAllTimeByLibraryAccountsThisMonthUTC, interval);
    });
  }

  function updateUpdateAllTimeByLibraryAccountsLastMonthUTC(){
    updateUpdateAllTimeByLibraryAccountsUTC('chartUpdateAllTimeByLibraryAccountsLastMonthUTC', "month", -30*24, 0, function(interval){
      timeoutRefreshUpdateAllTimeByLibraryAccountsLastMonthUTC = setTimeout(updateUpdateAllTimeByLibraryAccountsLastMonthUTC, interval);
    });
  }

  function updateUpdateAllTimeByLibraryAccountsUTC(chartObjName, periodUnit, fromHourOffset, toHourOffset, setTimerFunction){
    if (googleChartsLibLoaded){
      if (!window[chartObjName]){
        try{
          window[chartObjName] = new google.visualization.CandlestickChart(
            document.getElementById('divC' + chartObjName.substring(1)));
        }catch(err){
          window.console && console.log(err);
        }
      }
    }
    var chartObj = window[chartObjName];
    if(!chartObj){
      var interval = 1000 * refreshIntervalSlider.getValue();
      setTimerFunction(interval);
      return;
    }

    var timeFormatPattern = periodUnit == "day" ? "YYYYMMDD" : "YYYYMM";
    var query;
    query = "https://api.rtstatistics.com/statistics/AA$S2hKMyHhKFbkP6MBEUuS$Sdb3u_Nw8UOBzd9GKNeA/detail?"
      + "_period=1 " + periodUnit
      + "&_zone=UTC"
      + "&_columns=all"
      + "&_from=" + formatTime(fromHourOffset, 0, timeFormatPattern)
      + "&_to=" + formatTime(toHourOffset, 0, timeFormatPattern)
      + "&api_key=" + queryKey
      + "&numAccounts=";
    $.when($.ajax(query + "1"), $.ajax(query + "2"), $.ajax(query + "3"), $.ajax(query + "4"))
      .done(function(result1, result2, result3, result4){
        var data1 = result1[0];
        var data2 = result2[0];
        var data3 = result3[0];
        var data4 = result4[0];
        if (data1 && data2 && data3 && data4){
          var table = new google.visualization.DataTable();
          table.addColumn('string', "Number of accounts");
          table.addColumn('number', 'Seconds (Min)');
          table.addColumn('number', 'Seconds (Avg)');
          table.addColumn('number', 'Seconds (Avg)');
          table.addColumn('number', 'Seconds (Max)');
          cjtsd.setDataTableColumn(table, ["1 account", "2 accounts", "3 accounts", "4 accounts"], 0);
          cjtsd.setDataTableColumn(table, [].concat(data1.m || [null], data2.m || [null], data3.m || [null], data4.m || [null]), 1);
          cjtsd.setDataTableColumn(table, [].concat(data1.a || [null], data2.a || [null], data3.a || [null], data4.a || [null]), 2);
          cjtsd.setDataTableColumn(table, [].concat(data1.a || [null], data2.a || [null], data3.a || [null], data4.a || [null]), 3);
          cjtsd.setDataTableColumn(table, [].concat(data1.x || [null], data2.x || [null], data3.x || [null], data4.x || [null]), 4);

          chartObj.draw(table, {legend:'none', 'height':300});
        }else{
          window.console && console.log("No valid result for query '" + query + "', result1: " + result1 +
              ", result2: " + result2 + ", result3: " + result3 + ", result4: " + result4);
        }
      })
      .always(function(){
        var interval = 1000 * refreshIntervalSlider.getValue();
        setTimerFunction(interval);
      });
  }

  </script>

<!-- Block (1) END -->



</body>

</html>
