<!DOCTYPE html>

<html lang="en-US">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Demo &#8211; Live statistics: Trump vs. Clinton according to comments in &#8220;askreddit&#8221; | rtstatistics.com</title>

<link rel="profile" href="http://gmpg.org/xfn/11">

<link rel="pingback" href="./../../xmlrpc.php">

<!--[if lt IE 9]>
<script src="./wp-content/themes/zerif-lite/js/html5.js"></script>
<link rel="stylesheet" href="./wp-content/themes/zerif-lite/css/ie.css" type="text/css">
<![endif]-->

<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="rtstatistics.com &raquo; Feed" href="./../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="rtstatistics.com &raquo; Comments Feed" href="./../../comments/feed/index.html" />
<link rel='stylesheet' id='zerif_font-css'  href='./../../wp-content/themes/zerif-lite/css/zerif_slug_fonts.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_font_all-css'  href='./../../wp-content/themes/zerif-lite/css/open-sans_font_34678.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_bootstrap_style-css'  href='./../../wp-content/themes/zerif-lite/css/bootstrap.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_fontawesome-css'  href='./../../wp-content/themes/zerif-lite/css/font-awesome.min.css?ver=v1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_pixeden_style-css'  href='./../../wp-content/themes/zerif-lite/css/pixeden-icons.css?ver=v1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_style-css'  href='./../../wp-content/themes/zerif-lite/style.css?ver=v1' type='text/css' media='all' />
<link rel='stylesheet' id='zerif_responsive_style-css'  href='./../../wp-content/themes/zerif-lite/css/responsive.css?ver=v1' type='text/css' media='all' />
<link rel='stylesheet' id='customized_style-css'  href='./../../wp-content/themes/zerif-lite/css/customized.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='./../../wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='./../../wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='./../../wp-json/index.html' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="./../../xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="./index.html" />
<link rel='shortlink' href='./../../index.html?p=122' />
<link rel="alternate" type="application/json+oembed" href="./../../wp-json/oembed/1.0/embed/index.html?url=http%3A%2F%2F%2Fresources%2Flive-statistics-trump-vs-clinton-according-to-comments-in-askreddit%2F" />
<link rel="alternate" type="text/xml+oembed" href="./../../wp-json/oembed/1.0/embed/index.html?url=http%3A%2F%2F%2Fresources%2Flive-statistics-trump-vs-clinton-according-to-comments-in-askreddit%2F&#038;format=xml" />
<link rel="alternate" href="./index.html" hreflang="en" />
<link rel="alternate" href="http://zh.rtstatistics.com/zh-resources/live-statistics-trump-vs-clinton-according-to-comments-in-askreddit/" hreflang="zh" />
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-image: url('./../wp-content/uploads/2015/12/bubble_1920x1280.jpg'); background-repeat: repeat; background-position: top left; background-attachment: scroll; }
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70952510-1', {'siteSpeedSampleRate':100,'sampleRate':100});
  ga('send', 'pageview');

</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?309dadd6cd25f3a327bc34ca4c26df47";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<style type="text/css">
code{
  font-size:14px;
  color: #404040;
}
td code{
  background-color:white;
}
pre{
  font-size:15px;
}
</style>
<!-- Block (7) START-->
<script>var $=jQuery.noConflict();</script>

<link href="//cdn.bootcss.com/c3/0.4.10/c3.min.css" rel="stylesheet" type="text/css">
<script src="//apps.bdimg.com/libs/d3/3.4.8/d3.min.js" charset="utf-8"></script>
<script src="//cdn.bootcss.com/c3/0.4.10/c3.min.js"></script>

<script src="//apps.bdimg.com/libs/moment/2.8.3/moment.js"></script>
<script src="./../../wp-content/uploads/2016/04/cjtsd.min_.js"></script>

<link href="//cdn.bootcss.com/bootstrap-slider/6.1.1/css/bootstrap-slider.min.css" rel="stylesheet" type="text/css">
<script src="//cdn.bootcss.com/bootstrap-slider/6.1.1/bootstrap-slider.min.js"></script>

<script src="./../../wp-content/uploads/2016/04/loader.js"></script>
<!-- Block (7) END -->
<link rel="icon" href="./../../wp-content/uploads/2015/12/logo_240-150x150.png" sizes="32x32" />
<link rel="icon" href="./../../wp-content/uploads/2015/12/logo_240.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="./../../wp-content/uploads/2015/12/logo_240.png" />
<meta name="msapplication-TileImage" content="./wp-content/uploads/2015/12/logo_240.png" />

</head>




	<body class="page page-id-122 page-child parent-pageid-46 page-template page-template-template-fullwidth page-template-template-fullwidth-php" >






<!-- =========================

   PRE LOADER

============================== -->


<header id="home" class="header">

	<div id="main-nav" class="navbar navbar-inverse bs-docs-nav" role="banner">

		<div class="container-fluid">

			<div class="navbar-header responsive-logo">

				<button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">

				<span class="sr-only">Toggle navigation</span>

				<span class="icon-bar"></span>

				<span class="icon-bar"></span>

				<span class="icon-bar"></span>

				</button>



				<a href="./../../index.html" class="navbar-brand"><img src="../../wp-content/uploads/2015/12/logo_name_32w.png" alt="rtstatistics.com"></a>


			</div>

			<nav class="navbar-collapse bs-navbar-collapse collapse" role="navigation"   id="site-navigation">

				<ul id="menu-default-menu" class="nav navbar-nav navbar-right responsive-nav main-nav-list"><li id="menu-item-32" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-32"><a href="./../../products/index.html">Products</a></li>
<li id="menu-item-59" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-59"><a href="./../../solutions/index.html">Solutions</a></li>
<li id="menu-item-58" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-58"><a href="./../../pricing/index.html">Pricing</a></li>
<li id="menu-item-57" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor current-menu-ancestor current-menu-parent current-custom-parent current_page_parent current_page_ancestor menu-item-has-children menu-item-57"><a href="./../index.html">Resources</a>
<ul class="sub-menu">
	<li id="menu-item-93" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-93"><a href="./../how-to-send-data-to-rtstatistics-com-in-5-minutes/index.html">Tutorial: How to send data to rtstatistics.com in 5 minutes</a></li>
	<li id="menu-item-244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-244"><a href="./../how-to-setup-real-time-statistics-in-5-minutes/index.html">Tutorial: How to setup real-time statistics in 5 minutes</a></li>
	<li id="menu-item-128" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-122 current_page_item menu-item-128"><a href="./index.html">Demo &#8211; Live statistics: Trump vs. Clinton according to comments in &#8220;askreddit&#8221;</a></li>
	<li id="menu-item-112" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-112"><a href="./../live-usage-statistics-of-mobile-app-libbooks/index.html">Demo &#8211; Live usage statistics of mobile app &#8220;LibBooks&#8221;</a></li>
	<li id="menu-item-302" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor current-custom-parent menu-item-302"><a href="./../index.html">More resources &#8230;</a></li>
</ul>
</li>
<li id="menu-item-8" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-8"><a href="https://manage.rtstatistics.com/auth/login">Log in</a></li>
<li id="menu-item-37" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-37"><a href="#">Language/语言</a>
<ul class="sub-menu">
	<li id="menu-item-33-en" class="lang-item lang-item-2 lang-item-en lang-item-first current-lang menu-item menu-item-type-custom menu-item-object-custom menu-item-33-en"><a href="./index.html" hreflang="en-US" lang="en-US"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAIAAAD5gJpuAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAHzSURBVHjaYkxOP8IAB//+Mfz7w8Dwi4HhP5CcJb/n/7evb16/APL/gRFQDiAAw3JuAgAIBEDQ/iswEERjGzBQLEru97ll0g0+3HvqMn1SpqlqGsZMsZsIe0SICA5gt5a/AGIEarCPtFh+6N/ffwxA9OvP/7//QYwff/6fZahmePeB4dNHhi+fGb59Y4zyvHHmCEAAAW3YDzQYaJJ93a+vX79aVf58//69fvEPlpIfnz59+vDhw7t37968efP3b/SXL59OnjwIEEAsDP+YgY53b2b89++/awvLn98MDi2cVxl+/vl6mituCtBghi9f/v/48e/XL86krj9XzwEEEENy8g6gu22rfn78+NGs5Ofr16+ZC58+fvyYwX8rxOxXr169fPny+fPn1//93bJlBUAAsQADZMEBxj9/GBxb2P/9+S/R8u3vzxuyaX8ZHv3j8/YGms3w8ycQARmi2eE37t4ACCDGR4/uSkrKAS35B3TT////wADOgLOBIaXIyjBlwxKAAGKRXjCB0SOEaeu+/y9fMnz4AHQxCP348R/o+l+//sMZQBNLEvif3AcIIMZbty7Ly6t9ZmXl+fXj/38GoHH/UcGfP79//BBiYHjy9+8/oUkNAAHEwt1V/vI/KBY/QSISFqM/GBg+MzB8A6PfYC5EFiDAABqgW776MP0rAAAAAElFTkSuQmCC" title="English" alt="English" /><span style="margin-left:0.3em;">English</span></a></li>
	<li id="menu-item-33-zh" class="lang-item lang-item-5 lang-item-zh menu-item menu-item-type-custom menu-item-object-custom menu-item-33-zh"><a href="../../zh-resources/live-statistics-trump-vs-clinton-according-to-comments-in-askreddit/index.html" hreflang="zh-CN" lang="zh-CN"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAALCAIAAAD5gJpuAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAFqSURBVHjaYrzOwPAPjJgYQEDAleHVbhADIvgHLPgHiQ0QQCxAlkR9NW8sw+cV/1gV/7Gb/hV4+vfzhj8Mv/78//Pn/+/f/8AkhH1t0yaAAAJp4I37zyz2lDfu79uqv/++/WYz+cuq/vvLxt8gdb+A5K9/v34B2SyyskBLAAII5JAva/7/+/z367a/f3/8ZuT9+//Pr78vQUrB6n4CSSj6/RuoASCAWEDO/fD3ddEfhv9/OE3/sKj8/n7k9/fDQNUIs/+DVf8HawAIIJCT/v38C3Hr95N/GDh/f94AVvT7N8RUBpjxQAVADQABBNLw/y/Ifwy/f/399ufTOpDBEPf8g5sN0QBEDAwAAQTWABEChgOSA9BVA00E2wAQQCANQBbEif/AzoCqgLkbbBYwWP/+//sXqBYggFhAkfL7D7OkJFCOCSj65zfUeFjwg8z++/ffX5AGoGKAAGI8jhSRyIw/SJH9D4aAYQoQYAA6rnMw1jU2vQAAAABJRU5ErkJggg==" title="中文 (中国)" alt="中文 (中国)" /><span style="margin-left:0.3em;">中文 (中国)</span></a></li>
</ul>
</li>
</ul>
			</nav>

		</div>

	</div>

	<!-- / END TOP BAR -->

<div class="clear"></div>

</header> <!-- / END HOME SECTION  -->



	<div id="content" class="site-content">

<div class="container">



<div class="content-left-wrap col-md-12">

	<div id="primary" class="content-area">

		<main id="main" class="site-main" role="main">



			


				


<article id="post-122" class="post-122 page type-page status-publish hentry">

	<header class="entry-header">
			</header><!-- .entry-header -->



	<div class="entry-content">

		<h1>Live statistics: Trump vs. Clinton according to comments in &#8220;askreddit&#8221;</h1>
<p>&nbsp;</p>
<p>Reddit entries are organized into areas of interest called &#8220;subreddits&#8221;. <a href="https://www.reddit.com/r/AskReddit/" target="_blank">&#8220;askreddit&#8221;</a> is one of them.</p>
<p>Public comments posted in &#8220;askreddit&#8221; are collected and sent through REST API (POST <a href="https://api.rtstatistics.com/" target="_blank">https://api.rtstatistics.com/dataset/{id}/items</a>) from a server. rtstatistics.com does the number crunching to generate the statistics. This page queries the statistics through REST API (GET <a href="https://api.rtstatistics.com/" target="_blank">https://api.rtstatistics.com/statistics/{id}/detail</a>). The delay from the event gets received to updated statistics can be queried is typically less than 1 second.</p>
<p>Charts on this page use <a href="http://c3js.org/">c3.js</a>+<a href="https://d3js.org/">d3.js</a> for drawing the charts, and <a href="https://github.com/james-hu/cjtsd-js">cjtsd-js</a> is used for transforming the query results into the format that c3.js and Google Charts require.</p>
<p>Source code of this demo can be found <a href="https://github.com/james-hu/rtstatistics-demo-pages" target="_blank">here</a>.</p>
<p>You can adjust the refresh interval of these charts manually. During refreshes, if new statistics are fetched from the server, the charts will reflect the changes. If you don’t touch it for a few minutes, the interval will be automatically increased until reaching 60 seconds.</p>
<p>Refresh interval (seconds):      <input id="refreshIntervalSlider" type="text" /></p>
<p>&nbsp;</p>
<h3>Trump vs. Clinton: number of comments mentioned per 1 hour (UTC)</h3>
<h4>Latest hourly statistics: <span id="latestTrumpVsClintonPer1HourUTC" style="color: blue;"></span></h4>
<div id="chartTrumpVsClintonPer1HourUTC"></div>
<p>This chart shows in the last 72 hours how many comments have &#8220;Trump&#8221; mentioned, how many have &#8220;Clinton&#8221; mentioned, and how many have both of them mentioned. It also shows the percentage of those comments in all comments posted.</p>
<p>The chart is drawn with c3.js and displays UTC time.</p>
<p>&nbsp;</p>
<h3>Total number of comments per 1 hour (UTC)</h3>
<h4>Latest hourly statistics: <span id="latestTotalCommentsCountsPer1HourUTC" style="color: blue;"></span></h4>
<div id="chartTotalCommentsCountsPer1HourUTC"></div>
<p>This chart shows total number of comments posted per 1 hour in the last 72 hours.</p>
<p>The chart is drawn with c3.js and displays UTC time.</p>
<p>&nbsp;</p>
<h3>Total number of distinct comments per 1 hour (UTC)</h3>
<h4>Latest hourly statistics: <span id="latestTotalDistinctCommentsCountsPer1HourUTC" style="color: blue;"></span></h4>
<div id="chartTotalDistinctCommentsCountsPer1HourUTC"></div>
<p>This chart shows total number of distinct comment content posted per 1 hour in the last 72 hours. For each hour, usually the number of distinct comments is smaller than the number of total comments.</p>
<p>The chart is drawn with c3.js and displays UTC time.</p>
<p>&nbsp;</p>
<h2>Other resources</h2>
<ul>
<li><a href="./../live-usage-statistics-of-mobile-app-libbooks/index.html">Demo – Live statistics: Usage of mobile app “LibBooks”</a></li>
<li><a href="http://en.rtstatistics.com/resources/how-to-send-data-to-rtstatistics-com-in-5-minutes/">Tutorial: How to send data to rtstatistics.com in 5 minutes</a></li>
<li><a href="./../how-to-setup-real-time-statistics-in-5-minutes/index.html">Tutorial: How to setup real-time statistics in 5 minutes</a></li>
</ul>

		
	</div><!-- .entry-content -->

	
</article><!-- #post-## -->


				


			


		</main><!-- #main -->

	</div><!-- #primary -->

</div><!-- .content-left-wrap -->




</div><!-- .container -->


	</div><!-- .site-content -->

<footer id="footer">

<div class="container">



	<div class="col-md-3 company-details"><div class="icon-top green-text"><img src="./../../wp-content/themes/zerif-lite/images/envelope4-green.png"></div><a href="mailto:info@rtstatistics.com">info@rtstatistics.com</a></div><div class="col-md-3 copyright"><ul class="social"><li><a target="_blank" href="#"><i class="fa fa-facebook"></i></a></li><li><a target="_blank" href="#"><i class="fa fa-twitter"></i></a></li><li><a target="_blank" href="http://www.linkedin.com/company/rtstatistics-com"><i class="fa fa-linkedin"></i></a></li></ul>Copyright ©2015-2016 Real-time Statistics Technologies</div>
</div> <!-- / END CONTAINER -->

</footer> <!-- / END FOOOTER  -->



<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/bootstrap.min.js?ver=20120206'></script>
<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/jquery.knob.js?ver=20120206'></script>
<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/smoothscroll.js?ver=20120206'></script>
<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/scrollReveal.js?ver=20120206'></script>
<script type='text/javascript' src='./../../wp-content/themes/zerif-lite/js/zerif.js?ver=20120206'></script>

<!-- Block (4) START-->
  <script>
  var queryKey = "r1ANSKf9wlQPOXyFVn2zwCChWTGc6fzOIH4sJYmM2pdCYljrH-rroXFZqN6GWkmW9Bb001Zdtf7vDQ8gXvaT-g";

  var refreshIntervalSlider;
  var timeoutRefreshRefreshIntervalSlider;

  var chartTotalCommentsCountsPer1HourUTC;
  var timeoutRefreshTotalCommentsCountsPer1HourUTC;

  var chartTotalDistinctCommentsCountsPer1HourUTC;
  var timeoutRefreshTotalDistinctCommentsCountsPer1HourUTC;

  var chartTrumpVsClintonPer1HourUTC;
  var timeoutRefreshTrumpVsClintonPer1HourUTC;


  $(function(){
    bindChartsAndStartRefresh();
  });

  function bindChartsAndStartRefresh(){
    chartTotalCommentsCountsPer1HourUTC = c3.generate({
      bindto: '#chartTotalCommentsCountsPer1HourUTC',
      data: {
        x: 'time',
        xFormat: '%Y-%m-%d %H:%M',
        columns: [
        ],
        type: 'bar'
      },
      bar: {
        width: {
          ratio: 0.8
        }
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            count: 72,
            culling: {
              max: 3
            },
            format: '%Y-%m-%d %H:00'
          }
        },
        y: {
          tick: {
            format: d3.format(",")
          }
        }
      }
    });

    chartTotalDistinctCommentsCountsPer1HourUTC = c3.generate({
      bindto: '#chartTotalDistinctCommentsCountsPer1HourUTC',
      data: {
        x: 'time',
        xFormat: '%Y-%m-%d %H:%M',
        columns: [
        ],
        type: 'bar'
      },
      bar: {
        width: {
          ratio: 0.8
        }
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            count: 72,
            culling: {
              max: 3
            },
            format: '%Y-%m-%d %H:00'
          }
        },
        y: {
          tick: {
            format: d3.format(",")
          }
        }
      }
    });

    chartTrumpVsClintonPer1HourUTC = c3.generate({
      bindto: '#chartTrumpVsClintonPer1HourUTC',
      data: {
        x: 'time',
        xFormat: '%Y-%m-%d %H:%M',
        columns: [
        ],
        groups: [['clintonOnly', 'both', 'trumpOnly']],
        order: null,
        names:{
          'trumpOnly': 'Mentioned "Trump" only',
          'both': 'Mentioned both "Trump" and "Clinton"',
          'clintonOnly' : 'Mentioned "Clinton" only',
          'ratio' : 'Percentage of those mentioned either "Trump" or "Clinton" in all comments'
        }
      },
      point: {
        show: false
      },
      axis: {
        x: {
          type: 'timeseries',
          tick: {
            count: 72,
            culling: {
              max: 3
            },
            format: '%Y-%m-%d %H:00'
          }
        },
        y: {
          tick: {
            format: d3.format(",")
          }
        },
        y2: {
          show: true,
          tick: {
            format: d3.format(".2%")
          }
        }
      }
    });

    startRefresh();
  }

  function startRefresh(){
    refreshIntervalSlider = new Slider("#refreshIntervalSlider", {
      min: 1,
      max: 60,
      value: 1,
      tooltip_position: "bottom"
    });
    refreshIntervalSlider.on("slideStop", onNewRefreshInterval);
    refreshIntervalSlider.on("slideEnabled", onNewRefreshInterval);

    onNewRefreshInterval();

    $("body").mousemove(function(){
      if (refreshIntervalSlider.getValue() > 1){
        refreshIntervalSlider.setValue(1);
        onNewRefreshInterval();
      }
    });
  }

  function onNewRefreshInterval(){
    clearTimeout(timeoutRefreshRefreshIntervalSlider);
    resetRefreshing();
    var seconds = refreshIntervalSlider.getValue();
    if (seconds < 60){
      timeoutRefreshRefreshIntervalSlider = setTimeout(function(){
        var seconds = refreshIntervalSlider.getValue();
        if (seconds < 60){
          refreshIntervalSlider.disable();
          if (seconds < 10){
            refreshIntervalSlider.setValue(10);
          }else if (seconds < 20){
            refreshIntervalSlider.setValue(20);
          }else if (seconds < 30){
            refreshIntervalSlider.setValue(30);
          }else if (seconds < 40){
            refreshIntervalSlider.setValue(40);
          }else if (seconds < 50){
            refreshIntervalSlider.setValue(50);
          }else{
            refreshIntervalSlider.setValue(60);
          }
          refreshIntervalSlider.enable();
        }
      }, 60000 * (2 + Math.floor(seconds/30)));  // increase values after n minutes
    }
  }

  function resetRefreshing(){
    clearTimeout(timeoutRefreshTotalCommentsCountsPer1HourUTC);
    updateTotalCommentsCountsPer1HourUTC();

    clearTimeout(timeoutRefreshTotalDistinctCommentsCountsPer1HourUTC);
    updateTotalDistinctCommentsCountsPer1HourUTC();

    clearTimeout(timeoutRefreshTrumpVsClintonPer1HourUTC);
    updateTrumpVsClintonPer1HourUTC();
  }

  function formatTime(hourOffset, zoneOffset, format){
    if (zoneOffset === undefined){
      zoneOffset = 0;
    }
    var now = Date.now() + zoneOffset;
    if (format === undefined){
      format = "YYYYMMDDHHmm";
    }
    return moment(now + 1000*60*60*hourOffset).utc().format(format);
  }

  function updateTotalCommentsCountsPer1HourUTC(){
    var query;
    query = "https://api.rtstatistics.com/statistics/AA$wSRF3Rrymh6zziPjz6Ui$SEWF2vekQI6bzP3peZq1/detail?"
      + "_period=1 hour"
	  + "&_zone=UTC"
      + "&_columns=count"
      + "&_from=" + formatTime(-72)
      + "&_to=" + formatTime(1)
      + "&api_key=" + queryKey;
    $.ajax(query)
      .done(function(result){
        if (!result.error){
          var data = result;
          var timeCol = cjtsd.getFormattedTimestamps(data, 'YYYY-MM-DD HH:mm', 'time');
          var dataCol = cjtsd.prepend(data.c, 'Total number of comments per 1 hour')
		  var colLen = timeCol.length;
		  if (colLen > 1){
			  $("#latestTotalCommentsCountsPer1HourUTC").html(timeCol[colLen-1] + ": " + dataCol[colLen-1]);
		  }
           chartTotalCommentsCountsPer1HourUTC.load({
            columns: [
              timeCol,
              dataCol
            ]
          });
          $("#chartTotalCommentsCountsPer1HourUTC .tick line").css("opacity", 0);
        }else{
          if (console && console.log){
            console.log("No valid result for query '" + query + "', result: " + result);
          }
        }
      })
      .always(function(){
        var interval = 1000 * refreshIntervalSlider.getValue();
        timeoutRefreshTotalCommentsCountsPer1HourUTC = setTimeout(updateTotalCommentsCountsPer1HourUTC, interval);
      });
  }


  function updateTotalDistinctCommentsCountsPer1HourUTC(){
    var query;
    query = "https://api.rtstatistics.com/statistics/AA$wSRF3Rrymh6zziPjz6Ui$Jz3RGMAE-wkA4LO53YtJ/detail?"
      + "_period=1 hour"
	  + "&_zone=UTC"
      + "&_columns=unique"
      + "&_from=" + formatTime(-72)
      + "&_to=" + formatTime(1)
      + "&api_key=" + queryKey;
    $.ajax(query)
      .done(function(result){
        if (!result.error){
          var data = result;
          var timeCol = cjtsd.getFormattedTimestamps(data, 'YYYY-MM-DD HH:mm', 'time');
          var dataCol = cjtsd.prepend(data.n, 'Total number of distinct comments per 1 hour')
    		  var colLen = timeCol.length;
    		  if (colLen > 1){
    			  $("#latestTotalDistinctCommentsCountsPer1HourUTC").html(timeCol[colLen-1] + ": " + dataCol[colLen-1]);
    		  }
          chartTotalDistinctCommentsCountsPer1HourUTC.load({
            columns: [
              timeCol,
              dataCol
            ]
          });
          $("#chartTotalDistinctCommentsCountsPer1HourUTC .tick line").css("opacity", 0);
        }else{
          if (console && console.log){
            console.log("No valid result for query '" + query + "', result: " + result);
          }
        }
      })
      .always(function(){
        var interval = 1000 * refreshIntervalSlider.getValue();
        timeoutRefreshTotalDistinctCommentsCountsPer1HourUTC = setTimeout(updateTotalDistinctCommentsCountsPer1HourUTC, interval);
      });
  }

  function updateTrumpVsClintonPer1HourUTC(){
    var query;
    query = "https://api.rtstatistics.com/statistics/STATISTICS_ID/detail?"
      + "_period=1 hour"
      + "&_zone=UTC"
      + "&_columns=count"
      + "&_from=" + formatTime(-72)
      + "&_to=" + formatTime(1)
      + "&api_key=" + queryKey;
    var queryTrump = query.replace("STATISTICS_ID", "AA$wSRF3Rrymh6zziPjz6Ui$Qe64KNj0riG-HNkrl4Wt");
    var queryClinton = query.replace("STATISTICS_ID", "AA$wSRF3Rrymh6zziPjz6Ui$yFJKZCswJJ7JI3pMCyTL");
    var queryBoth = query.replace("STATISTICS_ID", "AA$wSRF3Rrymh6zziPjz6Ui$noex9b7smDIGk57uL5uZ");
    var queryAll = query.replace("STATISTICS_ID", "AA$wSRF3Rrymh6zziPjz6Ui$SEWF2vekQI6bzP3peZq1");

    $.when($.ajax(queryTrump), $.ajax(queryClinton), $.ajax(queryBoth), $.ajax(queryAll))
      .done(function(resultTrump, resultClinton, resultBoth, resultAll){
        var dataTrump = resultTrump[0];
        var dataClinton = resultClinton[0];
        var dataBoth = resultBoth[0];
        var dataAll = resultAll[0];
        if (dataTrump && dataClinton && dataBoth && dataAll){
          var rawTimestamps = dataAll.t;
          var timeCol = cjtsd.getFormattedTimestamps(dataAll, 'YYYY-MM-DD HH:mm', 'time');
          var countsTrump = cjtsd.alignByTimestamps(rawTimestamps, dataTrump.t, dataTrump.c);
          var countsClinton = cjtsd.alignByTimestamps(rawTimestamps, dataClinton.t, dataClinton.c);
          var countsBoth = cjtsd.alignByTimestamps(rawTimestamps, dataBoth.t, dataBoth.c)
            .map(function(val, i){return val == null ? 0 : val;});
          var countsAll = dataAll.c;
          var countsTrumpOnly = cjtsd.substract(countsTrump, countsBoth);
          var countsClintonOnly = cjtsd.substract(countsClinton, countsBoth);
          var countsAny = cjtsd.add(cjtsd.add(countsTrumpOnly, countsClintonOnly), countsBoth);
          var mentionedRatio = cjtsd.merge(function(all, mentioned){
            if (mentioned === null){
              return 0;
            }else{
              return mentioned / all;
            }
          }, countsAll, countsAny);

          var dataLen = rawTimestamps.length;
    		  if (dataLen > 1){
    			  $("#latestTrumpVsClintonPer1HourUTC").html(timeCol[dataLen] + ": "
              + countsTrumpOnly[dataLen-1] + ":" + countsBoth[dataLen-1] + ":" + countsClintonOnly[dataLen-1]
              + ", " + Math.round(mentionedRatio[dataLen-1]*1000000)/10000 + "%");
    		  }

          chartTrumpVsClintonPer1HourUTC.load({
            columns:[
              timeCol,
              cjtsd.prepend(countsClintonOnly, 'clintonOnly'),
              cjtsd.prepend(countsBoth, 'both'),
              cjtsd.prepend(countsTrumpOnly, 'trumpOnly'),
              cjtsd.prepend(mentionedRatio, 'ratio')
            ],
            types:{
              trumpOnly: 'area-spline',
              both: 'area-spline',
              clintonOnly: 'area-spline',
              ratio: 'line'
            },
            axes: {
              trumpOnly: 'y',
              both: 'y',
              clintonOnly: 'y',
              ratio: 'y2'
            }
          });
          $("#chartTrumpVsClintonPer1HourUTC .tick line").css("opacity", 0);
        }else{
          if (console && console.log){
            console.log("No valid result for query '" + query + "', resultTrump: " + resultTrump
              + ", resultClinton: " + resultClinton + ", resultBoth: " + resultBoth + ", resultAll: " + resultAll);
          }
        }

      })
      .always(function(){
        var interval = 1000 * refreshIntervalSlider.getValue();
        timeoutRefreshTrumpVsClintonPer1HourUTC = setTimeout(updateTrumpVsClintonPer1HourUTC, interval);
      });
  }


  </script>

<!-- Block (4) END -->



</body>

</html>
